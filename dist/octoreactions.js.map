{"version":3,"sources":["Octoreactions.js"],"names":[],"mappings":"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","file":"octoreactions.js","sourcesContent":["var PLUS_SELECTOR = '.reaction-summary-item[value~=\"+1\"]'\nvar MINUS_SELECTOR = '.reaction-summary-item[value~=\"-1\"]'\nvar SMILE_SELECTOR = '.reaction-summary-item[value~=\"smile\"]'\nvar THINKING_SELECTOR = '.reaction-summary-item[value~=\"thinking_face\"]'\nvar TADA_SELECTOR = '.reaction-summary-item[value~=\"tada\"]'\nvar HEART_SELECTOR = '.reaction-summary-item[value~=\"heart\"]'\n\n\nvar REACTION_OPTION_SELECTORS = [\n  PLUS_SELECTOR,\n  MINUS_SELECTOR,\n  SMILE_SELECTOR,\n  THINKING_SELECTOR,\n  TADA_SELECTOR,\n  HEART_SELECTOR\n]\n\n\nfunction Octoreactions(owner, repo) {\n\n  this.owner = owner;\n  this.repo = repo;\n\n  // this.renderIssue('easyCZ', 'octoreactions', 1)\n  // this.getReactions('https://github.com/easyCZ/octoreactions/issues/1', function (count) {\n  //   console.log('pluses', count);\n  // });\n\n  // var that = this;\n  // $('.table-list-issues li').each(function (i, issue) {\n  //   debugger;\n  //   var links = $(issue).find('.issue-title-link');\n  //   var $header = $(issue).find('.issue-comments');\n\n  //   if (links.length === 0) return;\n\n  //   that.get(links.attr('href'), function (success, data) {\n  //     var reactions = $(data).find('.reaction-summary-item[value~=\"+1\"]');\n\n  //     $header.append([\n  //       '<div class=\"Octoreactions-Count\">',\n  //         '<g-emoji class=\"emoji mr-1\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png\">üëç</g-emoji>',\n  //         '<span>',\n  //           reactions.length.toString(),\n  //         '</span>',\n  //       '</div>'\n  //     ].join(''))\n  //     // <g-emoji class=\"emoji mr-1\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png\">üëç</g-emoji>\n\n  //     console.log('Reactions:', reactions.length);\n  //   })\n  // })\n}\n\nOctoreactions.prototype.getPlus = function () {\n  return '<g-emoji class=\"emoji mr-1\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png\">üëç</g-emoji>';\n}\n\nOctoreactions.prototype.getIssueUrl = function getIssueUrl(owner, repo, issueId) {\n  return [\n    'https://github.com/', owner, '/', repo, '/issues/', issueId ? issueId : ''\n  ].join('');\n}\n\nOctoreactions.prototype.renderIssue = function (issueId) {\n  console.log('RenderIssue:', issueId);\n  var url = this.getIssueUrl(this.owner, this.repo, issueId);\n  var that = this;\n\n  this.getReactions(url, function onGetReactions(count) {\n    var $issueHeader = $('.flex-table-item-primary'),\n        $octoreactions = $('.Octoreactions-Count');\n\n    $octoreactions.remove();\n\n    $issueHeader.append([\n      '<span class=\"Octoreactions-Count\">',\n        that.getPlus(),\n        count.toString(),\n      '</span>'\n    ].join(''))\n  })\n}\n\nOctoreactions.prototype.renderIssueList = function (owner, repo, issues) {\n  issues.forEach(function (issue) {\n    var url = this.getIssueUrl(owner, repo, issue);\n\n    this.getReactions(url, function (count) {\n          $header.append([\n        '<div class=\"Octoreactions-Count\">',\n          '<g-emoji class=\"emoji mr-1\" fallback-src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png\">üëç</g-emoji>',\n          '<span>',\n            reactions.length.toString(),\n          '</span>',\n        '</div>'\n      ].join(''))\n\n    })\n  }.bind(this))\n}\n\nOctoreactions.prototype.getReactions = function getReactions(url, cb) {\n  return $.get(url, function onSuccess(data, status, jqxhr) {\n    var $html = $(data),\n        containers = $html.find('.comment-reactions-options');\n\n    var pluses = 0;\n    containers.each(function (index, container) {\n      var tokens = $(container).find(PLUS_SELECTOR).text().trim().split(' ');\n      return pluses += +tokens[tokens.length - 1]\n    })\n\n    return cb && cb(pluses);\n  })\n}\n\n\n\njQuery(document).ready(function ($) {\n  var pathname = window.location.pathname;\n  var tokens = pathname.split('/'),\n      owner = tokens[1],\n      repo = tokens[2];\n\n  if (!window.octoreactions)\n    window.octoreactions = new Octoreactions(owner, repo)\n\n  // Issue detail\n  if (pathname.match(/(\\w|\\/)*issues\\/\\d/)) {\n    var issueId = +tokens[tokens.length - 1];\n    octoreactions.renderIssue(issueId)\n  }\n\n  // Issue List\n  else if (pathname.match(/(\\w|\\/)*issues\\//)) {\n\n  }\n\n})\n"],"sourceRoot":"/source/"}